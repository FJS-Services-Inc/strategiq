{# def
    message: str,
    is_last: bool = False,
    result: bool = False,
    use_oob: bool = True
#}

{# Determine status type and styling #}
{% set is_error = message.startswith('Error:') %}
{% set is_loading = is_last and not result %}
{% set is_tool_message = message.startswith('Using tool') %}
{% set is_complete = "complete" in message.lower() or "done" in message.lower() %}
{% set status_label = 'Error' if is_error else ('Complete' if is_complete else ('In Progress' if is_loading else ('Processing' if is_tool_message else 'Status'))) %}
{% set status_class = 'status-item--error' if is_error else ('status-item--success' if is_complete else ('status-item--loading' if is_loading else 'status-item--info')) %}

{# Render status item with optional OOB swap #}
<article class="status-item {{ status_class }}"
         role="article"
         aria-label="{{ status_label }}: {{ message }}"
         {% if use_oob %}hx-swap-oob="beforeend:#status-timeline"
         {% endif %}>
    <div class="status-item__indicator"
         aria-hidden="true">
        {% if is_error %}
        <i class="fas fa-circle-xmark"></i>
        {% elif is_complete %}
        <i class="fas fa-circle-check"></i>
        {% elif is_loading %}
        <i class="fas fa-circle-notch fa-spin"></i>
        {% else %}
        <i class="fas fa-circle"></i>
        {% endif %}
    </div>
    <div class="status-item__content">
        <div class="status-item__header">
            {{ status_label }}
        </div>
        <div class="status-item__message">
            {{ message }}
        </div>
    </div>
</article>