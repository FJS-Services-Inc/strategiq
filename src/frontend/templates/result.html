{% if result %}
{% set r = result.dict() %}
<section class="section"
         id="result-container"
         aria-live="polite"
         aria-atomic="false"
         role="region"
         aria-label="SWOT Analysis Results">
    <div class="container">
        <h2 class="title is-2 has-text-centered mb-4"
            id="results-heading"
            tabindex="-1">
            <span aria-label="Analysis Complete">Analysis Complete</span> âœ¨
        </h2>

        {# Entity comparison header #}
        <div class="entity-header has-text-centered mb-6"
             role="region"
             aria-label="Entities analyzed">
            <span class="entity-badge entity-badge--primary"
                  aria-label="Primary entity: {{ r.primary_entity }}">
                <i class="fas fa-star mr-1"
                   aria-hidden="true"></i>
                {{ r.primary_entity }}
            </span>
            {% if r.comparison_entities %}
            <span class="entity-header__vs"
                  aria-label="versus">vs</span>
            {% for entity in r.comparison_entities %}
            <span class="entity-badge entity-badge--comparison"
                  aria-label="Compared entity: {{ entity }}">
                <i class="fas fa-building mr-1"
                   aria-hidden="true"></i>
                {{ entity }}
            </span>
            {% if not loop.last %}
            <span class="entity-header__sep"
                  aria-hidden="true">,</span>
            {% endif %}
            {% endfor %}
            {% endif %}
        </div>

        <div class="swot-grid"
             role="list"
             aria-label="SWOT Analysis Categories">
            {% set swot_categories = ['strengths', 'weaknesses', 'opportunities', 'threats'] %}
            {% for cat in swot_categories %}
            {% set val = r[cat] %}
            {# Determine card class and icon based on category #}
            {% set card_class = 'strength' if cat == 'strengths' else ('weakness' if cat == 'weaknesses' else ('opportunity' if cat == 'opportunities' else 'threat')) %}
            {% set icon = 'fa-arrow-trend-up' if cat == 'strengths' else ('fa-arrow-trend-down' if cat == 'weaknesses' else ('fa-lightbulb' if cat == 'opportunities' else 'fa-triangle-exclamation')) %}
            {% set category_label = 'Strengths - positive internal factors' if cat == 'strengths' else ('Weaknesses - negative internal factors' if cat == 'weaknesses' else ('Opportunities - positive external factors' if cat == 'opportunities' else 'Threats - negative external factors')) %}

            <article class="swot-card swot-card--{{ card_class }}"
                     role="listitem"
                     aria-labelledby="card-title-{{ cat }}"
                     tabindex="0">
                <div class="swot-card__header">
                    <div class="swot-card__icon"
                         aria-hidden="true">
                        <i class="fas {{ icon }}"></i>
                    </div>
                    <h3 class="swot-card__title"
                        id="card-title-{{ cat }}">
                        {{ cat.title() }}
                        <span class="sr-only">: {{ category_label }}</span>
                    </h3>
                    <span class="swot-card__count"
                          aria-label="{{ val|length }} items">{{ val|length }}</span>
                </div>
                <div class="swot-card__body">
                    <ul class="swot-list"
                        aria-label="{{ cat.title() }} list">
                        {% for value in val %}
                        <li class="swot-list__item">
                            <span class="swot-list__bullet"
                                  aria-hidden="true"></span>
                            <span class="swot-list__text">{{ value }}</span>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </article>
            {% endfor %}
        </div>

        {# Executive Summary Section #}
        {% if r.analysis %}
        <section class="box mt-6"
                 role="region"
                 aria-labelledby="summary-heading"
                 style="background-color: #FFFFFF; border-radius: 16px; border-left: 4px solid var(--brand-primary); box-shadow: var(--shadow-lg);">
            <h3 class="title is-4"
                id="summary-heading"
                style="color: var(--brand-primary);">
                <i class="fas fa-clipboard-list mr-2"
                   aria-hidden="true"></i>
                Executive Summary
            </h3>
            <div class="content"
                 style="color: #374151; line-height: 1.8; font-size: 1rem;">
                {{ r.analysis }}
            </div>
        </section>
        {% endif %}
    </div>
</section>
{% endif %}