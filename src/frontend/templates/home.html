{% extends "components/main/base.html" %}
{% block content %}
<section class="hero is-large gradient-hero">
    <div class="hero-body">
        <div class="container has-text-centered">
            <div class="hero-icon mb-4">
                <img src="{{ url_for('static', filename='purple.svg') }}"
                     alt="StrategIQ"
                     style="width: 80px; height: 80px;">
            </div>
            <h1 class="hero-title has-text-white">
                AI-Powered SWOT Analysis
            </h1>
            <p class="subtitle has-text-white-bis is-4 mb-5">
                Uncover strategic insights with generative AI.
                <br>
                Compare entities and generate actionable business intelligence.
            </p>
        </div>
    </div>
</section>

<section class="section"
         id="search">
    <Spinner></Spinner>
    <div class="search-container">
        <h2 class="title is-3 has-text-centered mb-5">Get Started</h2>
        <Form form_id="swotSearch"
              action={{ url_for('analyze_url') }}
              target="status"
              method="post">
            <div class="search-input-group"
                 role="search">
                <span class="search-icon"
                      aria-hidden="true">
                    <i class="fas fa-search"></i>
                </span>
                <input type="text"
                       class="search-input"
                       id="primary_entity"
                       name="primary_entity"
                       placeholder="Primary entity (e.g., Google or https://google.com)"
                       aria-label="Enter primary entity — a company name or URL"
                       aria-describedby="search-help"
                       required
                       autocomplete="off" />
                <button type="submit"
                        class="search-button"
                        aria-label="Run SWOT analysis"
                        hx-indicator='#spinner'
                        hx-on:click="
                        const [status, result, spinner] = ['#status', '#result', '#spinner'].map(id => document.querySelector(id));
                        spinner.classList.remove('is-hidden');
                        status.style.display = 'block';
                        result.style.display = 'none';
                        ">
                    <span class="button-text">Analyze</span>
                    <span class="button-icon"
                          aria-hidden="true">
                        <i class="fas fa-arrow-right"></i>
                    </span>
                </button>
            </div>
            <div class="comparison-input-group">
                <span class="comparison-icon"
                      aria-hidden="true">
                    <i class="fas fa-code-compare"></i>
                </span>
                <input type="text"
                       class="comparison-input"
                       id="comparison_entities"
                       name="comparison_entities"
                       placeholder="Compare with (optional) — e.g., Yahoo, Bing"
                       aria-label="Entities to compare against, comma-separated (optional)"
                       autocomplete="off" />
            </div>
        </Form>
        <div class="search-help">
            <i class="fas fa-info-circle"></i>
            Enter a company name or URL. Add competitors for a comparative SWOT.
        </div>
    </div>
</section>

<section class="section"
         id="analysis-content">
    <div class="box"
         id="status"
         hx-get={{ url_for('get_status') }}
         hx-trigger="load, every 1s"
         hx-swap="innerHTML"
         style="display: none">
    </div>
    <div class="box"
         id="result"
         hx-get={{ url_for('get_result') }}
         hx-trigger="load, every 1s[!this.querySelector('#result-container') || this.style.display === 'none']"
         hx-swap="innerHTML"
         hx-on:after-request="
            if(this.innerHTML.trim().length > 0) {
            console.log('Going to turn off the status element and load the result element.')
            const [statusDiv, spinner] = ['#status', '#spinner'].map(id => document.querySelector(id));
            if (statusDiv) statusDiv.style.display = 'none';
            if (spinner) spinner.classList.add('is-hidden');
            this.style.display = 'block'
            }
            ">
    </div>
</section>
{% endblock content %}